{% extends 'layout.html' %}{% block content %}<h2 class="title">Thanh toán (Mock)</h2><p>Suất: <b>{{ show.room }}</b> • {{ show.start_time }}</p><p>Ghế bạn đang giữ: <b>{{ seats|join(', ') if seats else 'Không có' }}</b></p><p>Tổng tiền: <b>{{ "{:,}".format(total) }}đ</b></p>{% if seats %}<img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=DEMO_PAYMENT" alt="QR" /><p>Quét QR (giả lập) hoặc bấm nút dưới để xác nhận đã thanh toán.</p><form method="post" action="/api/pay" onsubmit="event.preventDefault(); pay();"><input type="hidden" name="show_code" value="{{ show.code }}"><button class="btn success" id="payBtn">Đánh dấu ĐÃ THANH TOÁN</button></form><script>async function pay(){ const fd=new FormData(); fd.append('show_code','{{ show.code }}'); const res=await fetch('/api/pay',{method:'POST',body:fd}); const data=await res.json(); alert('Thanh toán: '+JSON.stringify(data)); window.location='{{ url_for("show_view", code=show.code) }}'; }</script>{% else %}<p>Không có ghế đang giữ. Vui lòng chọn ghế trước.</p>{% endif %}<a href="{{ url_for('show_view', code=show.code) }}" class="link">← Quay lại chọn ghế</a>{% endblock %}